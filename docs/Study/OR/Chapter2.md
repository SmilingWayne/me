<style>
.centertable 
{
  width: auto;/*表格宽度*/
  /* display: table;
  margin: auto;
  align: auto; */
}
</style>

# 线性规划的对偶理论


## 2.1 对偶问题


- 对偶：对同一个事物/问题从不同的角度（立场）提出的不同表述；

> 工厂利用手中资源生产两种产品，如何使得利润最大？
> 
> 对偶：假定一个公司试图把工厂的生产资源全部收购，那么至少要付出多少代价才能使工厂放弃生产活动、让出全部资源？

原问题：

$$max \hspace{3pt} z = \sum^{n}_{j = 1}{c_j x_j}$$

$$s.t. \sum^{n}_{j = 1}{a_{ij}x_j} \leq b_i  \hspace{12pt} ( i =1,...,m)$$

$$x_j \geq 0 \hspace{12pt} (j = 1,...,n)$$

对偶问题：

$$min \hspace{3pt} w = \sum^{m}_{i = 1}{b_i x_i}$$ 

$$s.t. \sum^{m}_{i = 1}{a_{ij}y_i} \geq c_i  \hspace{12pt} ( j =1,...,n) $$

$$ y_j \geq 0 \hspace{12pt} (i = 1,...,m)$$

- **对称形式**(Symmetric Form)，线性规划问题满足如下条件：一、决策变量均为非负数；约束条件为极大的时候均取"$\leq$"，当目标函数取极小的取"$\geq$"。对于其他形式的线性规划问题，可以先转化为对称形式，然后根据上述规则写出对偶问题。



| 原问题                                                     |                       对偶问题                       |
| ---------------------------------------------------------- | :--------------------------------------------------: |
| 约束条件系数矩阵                                           |                约束条件系数矩阵的转置                |
| 约束条件右端项向量                                         |                   目标函数系数向量                   |
| 目标函数系数向量                                           |                  约束条件右端项向量                  |
| 目标函数：$max \hspace{2pt} z = \sum^{n}_{j = 1}{c_j x_j}$ |   $min \hspace{2pt} w = \sum^{m}_{i = 1}{b_i y_i}$   |
| 约束条件数 $= m$                                           |                  决策变量个数 $= n$                  |
| 第$i$个约束条件: $\sum^{n}_{j=1}{a_{ij} x_j} \leq b_i$     |            第$i$个决策变量：$y_i \geq 0$             |
| 第$i$个约束条件: $\sum^{n}_{j=1}{a_{ij} x_j} \geq b_i$     |            第$i$个决策变量：$y_i \leq 0$             |
| 第$i$个约束条件: $\sum^{n}_{j=1}{a_{ij} x_j} = b_i$        |            第$i$个决策变量：$y_i$ 无约束             |
| 决策变量个数$=n$                                           |                   约束条件数 $= m$                   |
| 第$j$个决策变量：$x_j \geq 0$                              | 第$j$个约束条件$\sum^{n}_{j=1}{a_{ij} y_j} \geq c_i$ |
| 第$j$个决策变量：$x_j \leq 0$                              | 第$j$个约束条件$\sum^{n}_{j=1}{a_{ij} y_j} \leq c_i$ |
| 第$j$个决策变量：$x_j$ 无约束                              |  第$j$个约束条件$\sum^{n}_{j=1}{a_{ij} y_j} = c_i$   |


<div class = "centertable">
<table style = "margin: center">
    <tr>
        <td>目标函数</td> 
        <td>max</td> 
        <td>min</td> 
   </tr>
   <tr>
        <td>约束条件系数矩阵</td> 
        <td>A</td> 
        <td>AT</td> 
   </tr>
   <tr>
        <td>约束条件右端项向量</td> 
        <td>b</td> 
        <td>c</td> 
   </tr>
   <tr>
        <td>目标函数的系数向量</td> 
        <td>c</td> 
        <td>b</td> 
   </tr>
    <tr>
  		 <td rowspan = "4">函数约束与变量约束</td> 
      	 <td colspan="2">第k个约束 <----> 第k个向量</td>    
    </tr>
    <tr>
        <td colspan="2">约束个数 = 变量个数</td>    
    </tr>
    <tr>
        <td colspan="2">（非）规范约束 <----> 非负（正）变量</td>    
    </tr>
    <tr>
        <td colspan="2">等式约束 == 自由变量</td>    
    </tr>

</table>
</div>

> 上表中 `规范约束` 指的是前文`对称形式`下求解目标函数的性质和约束条件的大小约束对应关系，即：求解极大对应“$\leq$”，而求解极小对应“$\geq$”


## 2.2 对偶理论

⏰：针对的是“对称形式”的对偶问题，因为所有非对称形式都可以转化为对称形式；

### 2.2.1 弱对偶定理

- 如果$x = (x_1, x_2, x_3,...x_n)^{T}$是原问题的可行解，$y = (y_1, y_2,...,y_m)^{T}$ 是对偶问题的可行解，那么 $c^{T}x \leq b^T y$

> 说人话版本：原问题最优解目标函数是对偶问题目标函数值下界，对偶问题最优问题目标函数值是原问题目标函数值上界。
#### 推论2.1 

- 如果原问题有可行解并且目标函数值无界，那么它的对偶问题无可行解；同理如果对偶问题有可行解并且目标函数无界，那么原问题无可行解。

### 2.2.2 最优性定理

- 如果$x = (x_1, x_2, x_3,...x_n)^{T}$是原问题的可行解，$y = (y_1, y_2,...,y_m)^{T}$ 是对偶问题的可行解，并且$c^{T}x = b^T y$，（两者的目标函数值是相等的），那么x是原问题的最优解，y是对偶问题的最优解；

### 2.2.3 对偶定理
- 在互为对偶的两个线性规划问题中，如果其中一个有最优解，那么另外一个也有最优解，并且两者最优目标函数相等

#### 推论2.2 
- 如果原问题有可行解而其对偶问题没有可行解，那么原问题目标函数值无界；同理如果对偶问题有可行解而原问题没有可行解，那么对偶问题目标函数值无界。


### 2.2.4 互补松弛性

- 如果$x = (x_1, x_2, x_3,...x_n)^{T}$是原问题的可行解，$y = (y_1, y_2,...,y_m)^{T}$ 是对偶问题的可行解，那么它们为各自问题的最优解的充要条件是：$y^{T}_s x = 0, x^{T}_s y = 0$
    - 松约束、紧约束
  
- 详细版本：（双最优解情况）若原问题中某一约束条件对应的对偶变量值为非0，那么该约束条件取严格等式，若约束条件取严格等式，那么对应的对偶变量一定为0.也就是
    - 若 $y_i > 0$，那么 $\sum \limits^{n}_{j = 1}{a_{ij} x_j} = b_i$，松弛变量为0
    - 若 $\sum \limits^{n}_{j = 1}{a_{ij} x_j} < b_i$，也就是松弛变量不为0，则$y_i = 0$
> 因为原问题的约束条件对应对偶的目标函数，原问题的松弛变量为0，意味着对应的一个约束条件取等号，也就意味着这个约束条件对应的对偶问题的一个决策变量不为0；如果原问题的松弛变量不为0，那么意味着这是一个松约束，所以对偶问题对应的决策变量就必须为0；
>

## 2.3 影子价格

- 影子价格：单位第i种资源在最优方案中做出的贡献，或者说是相应资源对目标总利润的边际贡献；
- 影子价格依赖于资源的利用情况。

1. 影子价格的大小客观反映了资源在系统内的稀缺程度；
> 互补松弛型：如果生产过程中，资源$b_i$没有充分利用，那么影子价格为0，如果影子价格不为0意味着资源在生产中已经耗尽，也就是说这是一种稀缺资源。增加这种资源可以改善目标函数值，影子价格越高，反应资源在系统内越稀缺，增加该资源的供给对系统目标函数值的贡献越大。
1. 影子价格实际上是一种机会成本，检验数$\sigma_j = c_j - \sum \limits^{m}_{i = 1}{a_{ij} y_i}$ 反应的是利润 - 产品消耗的各项影子价格之和。只有利润大于机会成本，才会生产它有利。
2. 在出现退化的最优解的时候，会出现资源耗尽而不稀缺，但影子价格仍然大于0的情况，这时增加b只会带来资源的剩余，不增加利润。 

## 2.4 对偶单纯形法


> 单纯形法总体而言在：1⃣️ 先找到可行性；2⃣️ 再确定最优性；
> 对偶单纯形法相当于反了过来，先找对偶问题的可行解（也就是原问题的“最优”解），再寻找符合对偶问题最优性（也就是原问题可行性）的解；

- 首先满足最优性，然后逐渐逼近可行性。最优性： 检验数$\sigma_j$ ；可行性：右端项 $b_i$；

- 1⃣️ 列出初始单纯形表，要求$c_j - z_j$ 检验数小满足非正约束，也就是对偶问题为可行解，对$b_i$的值不做要求，但是
- 2⃣️ 最优性判断$(B^{-1}b)_{i} < 0$；


- 确定出基变量：没有找到可行解，总存在 $b_i < 0$，选择$b_i$中最小的，对应的变量$x_r$ 就是出基变量；
- 确定入基变量，上一步确定了出基变量，为了确保下一表中出基变量$r$行基变量为正值，需要找对应$a_{rj} < 0 ( j = m + 1,...,n)$的**非基变量**

  
$$\theta = \mathop{\min}  \{ \dfrac{c_j - z_j}{a_{rj} } | a_{rj} < 0 \} = \dfrac{c_s - z_s}{a_{rs} }$$

> 注意，对偶单纯形是先确定出基变量，再入基，而单纯形法正相反！
>
> 这里通过 $\theta$ 来保证每一次迭代后的$b_i$ 都是大于等于0的，就像是单纯形法中，利用$\theta$ 来保证每一次迭代后的检验数都是小于等于0的一样。


!!! Tips
    也就是无论怎么让基变量增大，都无法让$x_r$转换成非负，此时原问题一定找不到可行解，对偶问题目标函数值无界；
    $\theta$，通过这个$\theta$，保证每次迭代后都是$\leq 0$的。

- 由弱对偶性，对偶问题有可行解，那么原问题可能有可行解也可能无解；
    - 对新的基检查是否所有$b_i \geq 0$
    - 如果是，那么原问题有可行解，$CX = Y^{T}b$，原问题和对偶问题均取到最优解；
    - 如果不是，先检查一下$b_r$对应的所有的$a_{rj}$，如果满足对任意$a_{rj}$ 都有 $a_{rj} \geq 0$，那么线性规划问题没有可行解（因为b要从负数变成正，变号）；否则将选中变量当作入基变量，继续迭代；

- 继续迭代。



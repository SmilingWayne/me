# 数据包络分析

> 案例：王先生是一家快餐公司在某地分公司的经理，在该地区他管理10个下属的快餐连锁店，王先生试图对这10个连锁店去年的业绩进行评估，并依据**相对效率**提出关于这10家快餐连锁店经理年终奖的分配策略。连锁店的输出分为**平均利润、平均顾客满意度、增长率**；输入分为总工作时间和总成本。


-----------------

## Excel 求解

### 输入已知数据
首先输入已知数据，在单元格B4：K6中输入10个连锁店的输出数据，在单元格B9：K10中输入10个连锁店的输入数据。见表3.53。
### 决策变量
本模型中的决策变量是各连锁店的权重和连锁店5的效率指数E。用单元格B18：L18分别表示10个连锁店的权重和连锁店5的效率指数。
### 目标函数
本模型中的目标函数是使得连锁店5的效率指数E最小化。用单元格I20表示目标函数E，它也就是单元格L18中的决策变量E。在单元格I20中输入：=L18。
### 约束条件
- 如前所述，所有10个连锁店的权重之和应等于1，<u>同时每一个输出与输入指标都有一个对应的约束条件。所以本题共有六个约束条件。</u>第一个约束条件是10个连锁店的权重之和等于1。用单元格C21表示该约束条件的左边，并键入下式：=SUM(B18:K18)，得到10个连锁店的权重之和。用单元格表示E21表示第一个约束条件右边，并键入数字1，该约束条件的右边应等于右边。
- **第二个约束条件**是输出指标“满意度”对应的约束条件。用单元格C22表示第二个约束条件的左边，并键入下式：=SUMPRODUCT(B4:K4,\$B\$18:\$K\$18)，得到合成连锁店的满意度。将上述公式复制到单元格C23：C24，分别得到**第三和第四个约束条件**的左边，它们分别表示合成连锁店的净利润和增长率的输出指标。用单元格E22表示第二个约束条件的右边，并键入下式：=F4，得到连锁店4的满意度。合成连锁店的满意度应不小于连锁店5的满意度。将上述公式复制到单元格E23：E24，分别得到**第三和第四个约束条件**的右边，他们分别表示连锁店5的净利润和增长率。合成连锁店的净利润和增长率应不小于连锁店5的相应指标。

- **第五个约束条件**是输入指标“工作时间”对应的约束条件。用单元格C25表示第五个约束条件的左边，并键入下式SUMPRODUCT(B9:K9,\$B\$18:\$K\$18)，得到合成连锁店的工作时间。将上述公式复制到单元格C26，得到第六个约束条件左边的合成连锁店的生产成本。用单元格E25表示**第五个约束条件的右边**，并键入下式： =F9*\$L\$18，得到连锁店5的工作时间与效率指数E的乘积，它表示可提供给合成连锁店的工作时间资源，合成连锁店的工作时间应不超过其工作时间可提供量。将上述公式复制到单元格E26，得到第六个约束条件的右边，它表示允许的合成连锁店的生产成本，合成连锁店的生产成本应不超过生产成本的允许量。

------------

## 求解与分析

### 求解
- 运用Excel的规划求解功能，可以求出本问题的解。在目标规划求解参数框内键入目标函数、决策变量和约束条件。在“选择求解方法”中选择“单纯线性规划”，勾选“使无约束变量为非负数”选项，然后点击“求解”，即可在Excel表格中得到规划的解。
- 可知，最优解为$w_1 = w_2 = w_3 = w_4 = w_5 = w_7 = w_{10}, w_8 = 0.08, w_9 = 0.42, E = 0.76$

### 求解结果分析
- 从本题的最优解可知，目标函数 ，即连锁店5的效率指数得分为0.76。**这说明合成连锁店只要能够得到相当于连锁店5输入资源的76%作为其输入资源，就可以获得不小于连锁店5的输出**，因此，通过DEA分析得到的结论是：**合成连锁店比连锁店5具有更高的效率，而连锁店5则是相对低效的。**
- 从本题的最优解还可知道，==合成连锁店是由权重为50%的连锁店6，8%的连锁店8，42%的连锁店9加权平均所构成，即合成连锁店的投入与产出分别由权重为50%的连锁店6，8%的连锁店8，42%的连锁店9的投入和产出的加权平均所得出的==。通过对约束条件的分析，还可以得到关于连锁店5和其他连锁店的效率比较方面的信息。合成连锁店至少可以获得与连锁店5相同的输出，事实上，合成连锁店能够以小于连锁店5的输入资源，获得比连锁店5高2.75的利润率以及高0.06的增长率。可知，合成连锁店所需使用的工作时间和生产成本仅相当于连锁店5的76%，显然合成连锁店比连锁店5具有更高的效率。可以确定，连锁店5与其他连锁店相比，是相对低效率的。根据DEA分析得到的结果，管理者应进一步考察和改善连锁店5的运作情况，以确定采取哪些措施可以使得连锁店5更有效地使用资源，并获得更多的产出。


- 采用同样的方法可分别对其他连锁店进行DEA分析，通过这些分析，最终可得到如表3.55所示的结论。
表3.55  快餐连锁店DEA分析结论

| 连锁店 | 1    | 2   | 3   | 4    | 5    | 6   | 7    | 8   | 9   | 10   |
| ------ | ---- | --- | --- | ---- | ---- | --- | ---- | --- | --- | ---- |
| mp     | 0.94 | 1   | 1   | 0.89 | 0.76 | 1   | 0.97 | 1   | 1   | 0.96 |
从表3.55可见，连锁店2、3、6、8、9的效率指数为1，因此根据DEA分析结果，它们是相对弱有效或有效的，而其他连锁店则为DEA无效的。值得注意的是，这里得到的某连锁店的效率指数为1，并不一定表明该连锁店的运作已经处于最佳状态了，因为该连锁店可能处于弱有效状态。另一方面，对于DEA无效的连锁店而言，则存在其他有效连锁店的某个线性组合，可以得到一个合成连锁店，该合成连锁店能够以小于该低效连锁店的输入获得不小于该低效连锁店的输出。DEA认为，一个待评价单元应该能够具有与虚拟合成单元相同的运作效率，否则该待评价决策单元就是DEA低效的。

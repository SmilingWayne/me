## 模型和解
----

- 线形规划（Linear Programming）：是在**线形约束**下**求解线性目标函数最优值**的数学理论和方法。
      - 决策变量(Decision Variables):
      - 目标函数(Objective Function):
      - 约束条件(Constraints):

$$max(min)z = \sum^{n}_{j = 1}{c_jx_j}$$

$$s.t. \sum^{n}_{j = 1}{a_{ij} }{x_j} \leq ( =, \geq) b_i , (i = 1,...m)$$

$$x_j \geq 0, (j = 1,...n)$$

- 线性规划模型的标准形式

$$max \quad z = \sum^{n}_{j = 1}{c_jx_j}$$

$$s.t. \sum^{n}_{j = 1}{a_{ij} }{x_j} = b_i , (i = 1,...m)$$

$$x_j \geq 0, (j = 1,...n)$$


- 满足约束条件（1-9）和（1-10）的解 $x = (x_1, x_2,....,x_n)^{T}$ 称为线性规划的**可行解**(Feasible solution)，全部可行解的集合称为**可行域**(Feasible Region).

$$max \quad z = c^{T}x\tag{1-8}$$

$$s.t. Ax = b\tag{1-9}$$

$$ x \geq 0\tag{1-10}$$

- 使目标函数(1-8)达到最大值的可行解称为线性规划问题的**最优解**(Optimal Solution)。


- 基(Basis)：考虑等式约束方程组$Ax=b$，一般假设$m \times n$ 矩阵是行满秩的，此时如果$B$是$A$中一个 $m \times m$ 的满秩子矩阵（系数矩阵的一个满秩子矩阵），那么B是线性规划问题的一个**基**。
- 基向量：组成基的各个列向量，称为**基向量**；
- 基变量：与基向量相对应的各个变量称为**基变量**；
- **基本解**(Basic Solution)：令系数矩阵非基变量为0，得到的方程组的解，称为**基本解**；
- 基本解的个数是有限的，最多有$C^{m}_{n}$个。
- 基本可行解(Basic Feasible Solution)：满足非负约束条件（1-10）的基本解；
- 最优基本可行解(Basic Feasible Solution)：使目标函数(1-8)达到最大的基本可行解
- 最优基（Optimal Basis)：最优基本可行解对应的基；
- 凸集(Convex Set):
- 凸集的顶点（极点）：
- 两个凸集的交集仍然是凸集
- 图解法：
    1. 确定可行域
    2. 画出目标函数等值域
    3. 确定最优解 
- 线性规划解的**三个基本定理：**
    - 若线性规划问题存在可行解，那么可行解是凸集；
    - 线性规划问题的基本可行解和可行域的顶点一一对应；
    - 如果线性规划问题有最优解，那么一定存在一个基本可行解是最优解。


## 单纯形法
-----

- 单纯形法：
    - 迭代原理：先找到基本可行解，判断是否为最优解，如果不是，就转换到相邻的基本可行解，并且使得目标函数值不断增大，直到找到最优解；
    - 基的转换是在相邻基之间进行的，两个基本可行解之间有且仅有一基变量发生了变化，
    - 以最大化问题为例子，入基变量就是找到使得目标函数减小得最快的非基变量，也就是检验数最大的；出基变量就是最先因为资源受限降为0的基变量；
        - 检验数：$\sigma_{j} = (c^{T}_N - c^{T}_B B^{-1}N)_j$，如果线性规划问题要求极小值，那么当所有检验数$\sigma_{j} \geq 0$ 时候达到最优解。反之亦然。
    - 选中入基变量x_k和出基变量x_l，第k列和第l行的交叉点元素就是**旋转主元**，确保基矩阵始终是单位矩阵，对矩阵进行初等变换。
   
- 单纯形法具体步骤（按照==求解极大值问题==为例）
    - 列出单纯形表，要求$(B^{-1}b)_{i} \geq 0$
    - 进行最优性判断，如果所有的$\sigma_{j} = (c^{T} - c^{T}_B B^{-1}A)_j \leq 0$，那么当前基本可行解就是最优解；否则进入下一步
    - 确定换入变量：如果存在$\sigma_j > 0$，那么计算：$max \left\{ \sigma_j | \sigma_j > 0 \right\} = \sigma_s$,将对应的列变量x_s当作换入变量
    - 确定换出变量：检查换入变量$x_s$所在的第$s$列，<font color = red>如果所有的$a_{is} \leq 0$，那么线性规划问题有无界解</font>；如果存在$a_{is} > 0$，那么计算 $\theta = min \left\{ \frac{b_i}{a_{is}} | a_{is} > 0 \right\} = \frac{b_r}{a_{rs}}$ 。把对应的行变量$x_r$作为换出变量，$a_{rs}$ 作为旋转主元。
    - 重复2-4步骤，直到计算结束；
- 单纯形法的延伸
    - **人工变量法**：如果不能在系数矩阵中观察到单位矩阵，可以通过添加虚构的人工变量来构造单位矩阵。（人工变量的取值一定要是0，所以如果检验数$\sigma_j \leq 0$，基变量中依然有人工变量并且不为0，那么原问题无可行解
        - 大M法：在目标函数中的人工变量乘M（极大数）【不适用计算机运算】
        - 两阶段法：Step.1 目标函数为最小化“所有人工变量和”的线性规划问题，找到一个基本可行解（或者判断是否无可行解）；Step.2 去除人工变量，重新引入原问题的目标函数，利用第一阶段的解作为初始基本可行解
    - **无可行解**：在最优解中，人工变量必须为0，<u>判断一个线性规划问题无可行解的准则：在得到“最优基本可行解”时（以求解极大值问题为例，就是非基变量检验数都 $\sigma_j \leq 0$)，如果基变量中依然含有非0的人工变量（两阶段中第一阶段目标函数不是0）。</u>
    - **无界解**：
# 图论

!!! warning "多为概念"

- 如果一个图任意两点间至少存在一条链，那么这个图称为连通图；
- 连通且不含圈的无向图称为树；

## 最小生成树

### Prim算法

- 每次从没有选的边里选一条边，这个边权值要尽可能地小，使它和已有的不够成圈，直到选够 n - 1个边为止。

!!! tip
    有一个并查集的优化：迅速找到父节点并且回到源。


### Kruskal 算法

- 找每一个圈，把圈里最大的边删除掉，直到没有圈为止。

## 最短路问题




### Dijkstra 算法（单源最短路）

> 和动态规划问题不同，决策阶段不同，所以：

- 找到从某地到某地最短的路径：广度优先搜索解决赋权有向图或者无向图的单源最短路径问题；Dijkstra算法采用的是一种贪心的策略，声明一个数组dis来保存源点到各个顶点的最短距离和一个保存已经找到了最短路径的顶点的集合，初始时，原点 s 的路径权重被赋为 0 。若对于顶点 s 存在能直接到达的边（s,m），则把dis[m]设为w（s, m）,同时把所有其他（s不能直接到达的）顶点的路径长度设为无穷大。初始时，集合T只有顶点s。 
- 然后，从dis数组选择最小值，则该值就是源点s到该值对应的顶点的最短路径，并且把该点加入到T中，OK，此时完成一个顶点，然后，我们需要看看新加入的顶点是否可以到达其他顶点并且看看通过该顶点到达其他点的路径长度是否比源点直接到达短，如果是，那么就替换这些顶点在dis中的值。 
- 然后，又从dis中找出最小值，重复上述动作，直到T中包含了图的所有顶点。

!!! Tips 问题
    - 无法处理负权问题
    - 节点较多的话，计算量会加大


### Floyd算法 （多源最短路）

- Floyd算法又称为插点法，是一种利用**动态规划的思想**寻找给定的加权图中多源点之间最短路径的算法，

- 通过一个图的权值矩阵求出它的每两点间的最短路径矩阵。
- 我们的点如果在最短路上，那么我们用这个点去松弛最短路上的边的话，必定会松弛成功。因此，我们要想知道一个点在哪些点的最短路上，我们只需要用这个点去松弛所有边即可，松弛指的就是，把这个点作为一个“中转点”，遍历其出度和入度，如果距离更短就刷新图；
- 从一开始的邻接矩阵，遍历所有的节点，每次加入新结点都要更新==所有顶点之间的最短距离==，直到==所有顶点均可以作为中间顶点==之后（也就是对所有点都做了一次松弛），才算更新完毕，即可得到最终结果。


!!! Tips
    不能把负权加上最小的负数变整数这种做法，因为不是分阶段的问题，不能单纯地用DP的思想去解决。

    如果想要知道路径，还需要增加一个路由矩阵。

## 最大流问题

> 网络流，充分利用各个弧的容量，使得网络的通过流量最大。
>
> 有的问题可能有多个源/汇，但是可以加上虚拟源/汇，使得变成**单一源/汇**的问题，进而构成最大流问题
> **容量网络**：只有一个入次为0的点（源），只有一个出次为0的点（汇），其他的都是中间节点的网络；

- 最大流最小割定理：任何一个可行流的容量不会超过任何一个割集的容量。
    - 引入割的概念：把所有的点分成两个集合，起点在其中一个集合中，终点在另一个集合中，割的大小就是从起点割集S到终点割集T的个数；
    - 最小割：就是所有的割中，求一个最小的割，使得其容量**最小**；
    - 最大流和最小割问题是互为对偶的问题；

### Ford-Fulkson算法

> 在已经“犯错误”的情况下， 依然能够找到下一条路径；
>
> 前一次没有用过的边依然保留，为了纠正以前路径，可以把之前的路径反过来；
> 如此来实现不断地删除增广链；
> 
- 可行流f为最大流的充分必要条件是： ==当且仅当网络不存在增广链==;
- 给出一初始可行流，例如 fij =0
-  寻找增广链，若存在，通过添加反向路径，允许水流按照原来方向流回去，制造反向图residual graph；
      - 如果找到增广链，则通过该增广链调整、增加网络流
      - 若不存在增广链，则网络流不可再增加。求得最大流
- 管道网络中每条边的最大通过能力（容量）是有限的，实际流量不超过容量。最大流问题(maximum flow problem)，一种组合最优化问题，就是要讨论如何充分利用装置的能力，使得运输的流量最大，以取得最好的效果。求最大流的标号算法最早由福特和福克逊于1956年提出，20世纪50年代福特(Ford)、福克逊(Fulkerson)建立的“网络流理论”，是网络应用的重要组成成分。

## 最小费用流问题（Ford-Fulkerson 迭加算法）

- 输油管道，每个管道有运油量约束和成本，现在要从一个出发地运送特定数量的油（小于最大流的数量）到某个目的地，怎么运输，让成本最小。

1. 数学模型
2. 标号算法
3. 具体求解
4. 用它来表示其他问题

- 思路：尽可能发挥费用少的链路的潜力，寻找一条从i到j的费用最少的链路，并使得它的潜力充分发挥出来，直到达到运输数量要求； 总是在费用最小的增广路上增加流值，直到流值达到v。
- 标号算法
1. Dijkstra算法先找到最短路（也就是费用最少的路），用所有边上弧容量最小的；
2. 调整容量
3. 对所有弧，如果是饱和的，就设置原有的弧反向，如果不饱和，就设置一条反向负权弧（权重为费用）
4. 重复1-3操作，不过找最短路时候可以用枚举法操作结束的标志就是再也不存在一条从起点到终点的最短路；
      1. 注意：如果遇到了逆向流，流量最小值要用其原本的流量大小进行比较；

!!! Tip
    Ford-Fulkerson 的核心在于“塑造反向弧”，给了一个“纠错”的空间。使得一个已有的（但是效果不那么好的）可行的解可以在后续找的过程中被优化；

### 用最小费用流表示其他问题的建模

- 运输问题：直接设置一个汇总发地和一个汇总收地，只不过从汇总发地到原发地、原收地到汇总收地的费用全部是0；
  
- 指派问题：设置虚拟头和虚拟尾；每一个人到一个任务的容量都是1，费用即为成本；虚拟头到每个人、虚拟尾到每件事的容量也是1；

- 最短路问题：同指派问题，容量设置成1；起点供应节点设置一单位，需求供应节点设置一单位；
- 最大流问题：头和尾之间连接一条成本$M$的线路

